# Code and Scripts

## `data_acquisition.py`

This script is responsible for downloading all raw data from their respective public sources. It automates the retrieval process, ensuring that an identical raw dataset can be generated by any researcher.

* **Purpose**: To programmatically download historical stock prices, macroeconomic indicators, and financial news headlines.
* **Libraries**: `yfinance`, `pandas_datareader`, `requests`, `pandas`.
* **Process**:
   1. **Stock Data**: Connects to the Yahoo Finance API using the `yfinance` library to download daily price and volume data for the specified tickers (`^GSPC`, `^IXIC`, `TSLA`) within the 2010-2023 date range. The data is saved to `stock_data_2010-2023.csv`.
   2. **Macroeconomic Data**: Connects to the FRED API using the `pandas_datareader` library to fetch the time series for the Federal Funds Rate (`FEDFUNDS`), Real GDP (`GDPC1`), and the Consumer Price Index (`CPIAUCSL`). The raw data for each series is saved into a separate sheet in `macroeconomic_indicators_raw.xlsx`.
   3. **Sentiment Data**: Downloads the FNSPID news dataset directly from its public Hugging Face repository. The relevant CSV file containing news headlines is saved as `sentiment_data_sources.csv`.
* **Output**: `stock_data_2010-2023.csv`, `macroeconomic_indicators_raw.xlsx`, `sentiment_data_sources.csv`.

## `data_preprocessing_and_cleaning.py`

This script takes the raw data files as input and performs the necessary cleaning, transformation, and initial processing steps. This includes handling different data frequencies and quantifying qualitative data.

* **Purpose**: To clean raw data, align temporal frequencies, and convert textual news data into numerical sentiment scores.
* **Libraries**: `pandas`, `numpy`, `scipy`, `transformers`.
* **Process**:
   1. **Load Data**: Ingests the three raw data files generated by the acquisition script.
   2. **Macroeconomic Data Alignment**: Upsamples the monthly and quarterly macroeconomic data to a daily frequency using a forward-fill (`ffill`) method. This ensures the macroeconomic data is aligned with the daily stock prices.
   3. **Sentiment Analysis**:
      * Initializes a pre-trained financial sentiment analysis model from the `transformers` library (e.g., FinBERT), as implied by the paper's methodology.
      * Iterates through each news headline in `sentiment_data_sources.csv`, calculates a sentiment score (e.g., positive, negative, neutral), and converts it to a numerical value.
      * Aggregates the individual sentiment scores into a single average daily sentiment score for each ticker.
   4. **Outlier Handling**: Implements the outlier capping strategy mentioned in the paper. It calculates the Z-score for numerical columns and caps values that fall beyond a threshold (e.g., Â±3 standard deviations) to mitigate the effect of extreme values.
* **Output**: Intermediate, cleaned data files (e.g., `daily_macro_data.csv`, `daily_sentiment_scores.csv`).
